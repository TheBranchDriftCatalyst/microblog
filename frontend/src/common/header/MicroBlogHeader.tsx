"use client";
import Image from "next/image";
import CatalystHeader from "../components/CatalystHeader/CatalystHeader";
import { useHeader } from "../components/CatalystHeader/CatalystHeaderProvider";
import UserNavigationUnit from "../components/navigation_units/LoginNavUnit";
import StoriesNavigation from "../components/navigation_units/BlogPostNavUnit";
import { useEffect } from "react";
import { useAuth } from "../auth/AuthContext";
import { Avatar, AvatarImage, AvatarFallback } from "../ui/avatar";

const AnonUser = () => {
  const imageSrc = "data:image/png;base64,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"

  return (
    <img src={imageSrc} alt="Avatar" />
  )
  
}

const UserAvatar = (email) => {
  const { isAuthenticated } = useAuth();

  let avatar = null;

  if (!isAuthenticated) {
    avatar = (
      <Avatar>
        {/* <AvatarImage src="https://github.com/shadcn.png" alt="@shadcn" /> */}
        <AvatarFallback>??</AvatarFallback>
      </Avatar>
    )
  } else {
    avatar = (
      <Avatar>
        <AvatarImage src="https://github.com/shadcn.png" alt="@shadcn" />
        <AvatarFallback>CN</AvatarFallback>
      </Avatar>
    )
  }

  return avatar
}

export const MicroBlogHeader = () => {
  const { title, setTitle, avatar, setAvatar } = useHeader();
  const { isAuthenticated } = useAuth();


  useEffect(() => {
    setTitle('Microblog')
  })

  return (
    <CatalystHeader
      title={title}
      avatar={<UserAvatar />}
      navigationItems={[
        (<StoriesNavigation key="stories_nav" />), 
        (<UserNavigationUnit key="users_nav" />)
      ]}
    />
  );
}

export default MicroBlogHeader;